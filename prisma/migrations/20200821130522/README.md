# Migration `20200821130522`

This migration has been generated by Ebuka Umeh at 8/21/2020, 2:05:22 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "Role" AS ENUM ('USER', 'ADMIN');

CREATE TYPE "Protein" AS ENUM ('BEEF', 'CHICKEN');

CREATE TYPE "Status" AS ENUM ('PENDING', 'PROGRESS', 'COMPLETED', 'DELIVERED', 'CANCELLED');

ALTER TABLE "public"."Trip" DROP CONSTRAINT "Trip_tripId_fkey"

CREATE TABLE "public"."Food" (
"id" SERIAL,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"description" text  NOT NULL ,
"name" text  NOT NULL ,
"profile" text  NOT NULL ,
"profiles" text []  ,
"price" text  NOT NULL ,
"discountprice" text  NOT NULL ,
"category" integer []  ,
"liters" integer  NOT NULL DEFAULT 2,
"postedById" integer   ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."Order" (
"id" SERIAL,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"description" text  NOT NULL ,
"protein" "Protein" NOT NULL ,
"liters" integer  NOT NULL ,
"price" text  NOT NULL ,
"time" integer   ,
"status" "Status" NOT NULL ,
"postedById" integer   ,
"foodId" integer   ,
PRIMARY KEY ("id"))

ALTER TABLE "public"."User" DROP COLUMN "name",
ADD COLUMN "firstname" text   ,
ADD COLUMN "lastname" text   ,
ADD COLUMN "phone" text   ,
ADD COLUMN "whatsapp" text   ,
ADD COLUMN "role" "Role" NOT NULL DEFAULT E'USER',
ADD COLUMN "seller" boolean  NOT NULL DEFAULT false;

ALTER TABLE "public"."Food" ADD FOREIGN KEY ("postedById")REFERENCES "public"."User"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Order" ADD FOREIGN KEY ("postedById")REFERENCES "public"."User"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Order" ADD FOREIGN KEY ("foodId")REFERENCES "public"."Food"("id") ON DELETE SET NULL ON UPDATE CASCADE

DROP TABLE "public"."Trip";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200811113153-init..20200821130522
--- datamodel.dml
+++ datamodel.dml
@@ -1,8 +1,8 @@
 // 1
 datasource db {
   provider = "postgresql" 
-  url = "***"
+  url = "***"
 }
 // 2
 generator client {
@@ -21,17 +21,53 @@
 }
 model User {
   id       Int    @id @default(autoincrement())
-  name     String
+  firstname     String?
+  lastname  String?
   email    String @unique
   password String
   links    Link[]
   votes    Vote[]
-  trips    Trip[]
+  food     Food[]
   profile  String
+  phone    String?
+  whatsapp String?
+  role  Role  @default(USER)
+  seller Boolean @default(false)
 }
+model Food {
+  id          Int      @id @default(autoincrement())
+  createdAt   DateTime @default(now())
+  description String
+  name String
+  profile String 
+  profiles String[]
+  price  String 
+  discountprice   String
+  category Int[]
+  liters Int @default(2)
+  order Order[]
+  postedBy    User?     @relation(fields: [postedById], references: [id])
+  postedById  Int?
+}
+
+model Order {
+  id          Int      @id @default(autoincrement())
+  createdAt   DateTime @default(now())
+  description String
+  protein Protein
+  liters Int
+  price String
+  time Int?
+  status Status
+  postedBy    User?     @relation(fields: [postedById], references: [id])
+  postedById  Int?
+  food    Food?     @relation(fields: [foodId], references: [id])
+  foodId  Int?
+}
+
 model Vote {
   id     Int  @id @default(autoincrement())
   link   Link @relation(fields: [linkId], references: [id])
   linkId Int
@@ -40,18 +76,21 @@
   @@unique([linkId, userId])
 }
-model Trip {
-  id Int @id @default(autoincrement())
-  createdAt DateTime @default(now())
-  postedBy User? @relation(fields: [tripId], references: [id])
-  tripId Int?
-  distance Float 
-  destinationLatitude Float
-  destinationLongitude Float 
-  startAddress String
-  startLatitude Float
-  startLongitude Float
-  estimatedTime String 
-  destinationAddress String
+enum Role {
+  USER
+  ADMIN
+}
+
+enum Protein {
+  BEEF 
+  CHICKEN
+}
+
+enum Status {
+  PENDING 
+  PROGRESS 
+  COMPLETED
+  DELIVERED
+  CANCELLED
 }
```


